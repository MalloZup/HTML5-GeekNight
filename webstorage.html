<!DOCTYPE html>
<html>
  <head>
    <title>WebStorage</title>
    <link href='css/common.css' rel='stylesheet' type='text/css' />
    <link href='css/webstorage.css' rel='stylesheet' type='text/css' />
    <script type='text/javascript'>
      //<![CDATA[
        function init() {
          addEventListener('storage', function(e) {
            //alert("Change");
            var changes = document.querySelector("section.changes > pre");
            changes.innerHTML += e.key + " : " + e.oldValue + " -> " + e.newValue + " (" + e.url + ")\n";
          }, false);
        }
      //]]>
    </script>
  </head>
  <body onload='init();'>
    <header>
      <hgroup>
        <h1>WebStorage</h1>
        <h2>Key/Value Store for the Web</h2>
      </hgroup>
    </header>
    <section>
      <section>
        <section class='set'>
          <input class='key' type='text' />
          <input class='value' type='text' />
          <button>Set</button>
        </section>
        <section class='get'>
          <input type='text' />
          <button>Get</button>
          <span></span>
        </section>
        <section class='remove'>
          <input type='text' />
          <button>Remove</button>
        </section>
        <section class='clear'>
          <button>Clear</button>
        </section>
        <section class='all'>
          <button>All</button>
          <pre></pre>
        </section>
        <section class='changes'>
          <label>Changes</label>
          <pre></pre>
        </section>
      </section>
      <aside>
        <ul>
          <li>localStorage</li>
          <li>setItem(key, value)</li>
          <li>getItem(key)</li>
          <li>removeItem(key)</li>
          <li>clear</li>
          <li>length</li>
          <li>key(index)</li>
          <li>storage (event)</li>
          <li>sessionStorage</li>
        </ul>
      </aside>
    </section>
    <footer>
      <nav>
        <h1>Links</h1>
        <ul>
          <li>
            <a href='http://dev.w3.org/html5/webstorage/'>Spec</a>
          </li>
          <li>
            <a href='http://diveintohtml5.org/storage.html'>Dive Into HTML5</a>
          </li>
        </ul>
      </nav>
    </footer>
    <script type='text/javascript'>
      //<![CDATA[
        var setKey = document.querySelector("section.set > input.key");
        var setValue = document.querySelector("section.set > input.value");
        var getKey = document.querySelector("section.get > input");
        var getValue = document.querySelector("section.get > span");
        var removeKey = document.querySelector("section.remove > input");
        var all = document.querySelector("section.all > pre");
        document.querySelector("section.set > button").addEventListener('click', function() {
          localStorage.setItem(setKey.value, setValue.value);
        }, false);
        document.querySelector("section.get > button").addEventListener('click', function() {
          getValue.innerHTML = localStorage.getItem(getKey.value);
        }, false);
        document.querySelector("section.remove > button").addEventListener('click', function() {
          localStorage.removeItem(removeKey.value);
        }, false);
        document.querySelector("section.clear > button").addEventListener('click', function() {
          localStorage.clear();
        }, false);
        document.querySelector("section.all > button").addEventListener('click', function() {
          all.innerHTML = "";
          for (var i = 0; i < localStorage.length; i++) {
            var key = localStorage.key(i);
            all.innerHTML += key + " : " + localStorage.getItem(key) + "\n";
          }
        }, false);
      //]]>
    </script>
  </body>
</html>
